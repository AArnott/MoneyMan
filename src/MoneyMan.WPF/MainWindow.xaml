<Window x:Class="MoneyMan.MainWindow"
		xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"	
		xmlns:local="clr-namespace:MoneyMan"
		xmlns:vm="clr-namespace:Nerdbank.MoneyManagement.ViewModels;assembly=Nerdbank.MoneyManagement"
		xmlns:componentmodel="clr-namespace:System.ComponentModel;assembly=WindowsBase"
		mc:Ignorable="d"
		Title="Nerdbank Money Management" Height="350" Width="525">
	<Window.Resources>
		<vm:MainPageViewModel x:Key="viewModel">
			<vm:MainPageViewModel.AccountsPanel>
				<vm:AccountsPanelViewModel>
					<vm:AccountsPanelViewModel.Accounts>
						<vm:AccountViewModel Name="Checking" />
						<vm:AccountViewModel Name="Savings" />
					</vm:AccountsPanelViewModel.Accounts>
				</vm:AccountsPanelViewModel>
			</vm:MainPageViewModel.AccountsPanel>
			<vm:MainPageViewModel.CategoriesPanel>
				<vm:CategoriesPanelViewModel>
					<vm:CategoriesPanelViewModel.Categories>
						<vm:CategoryViewModel Name="Groceries" />
						<vm:CategoryViewModel Name="Utilities" />
					</vm:CategoriesPanelViewModel.Categories>
				</vm:CategoriesPanelViewModel>
			</vm:MainPageViewModel.CategoriesPanel>
		</vm:MainPageViewModel>
	</Window.Resources>
	<TabControl DataContext="{StaticResource viewModel}" TabStripPlacement="Bottom">
		<TabItem Header="Accounts" DataContext="{Binding AccountsPanel}">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="1*" />
					<ColumnDefinition Width="4*" />
				</Grid.ColumnDefinitions>
				<DockPanel Grid.Column="0">
					<ListView ItemsSource="{Binding Accounts}">
						<ListView.ItemTemplate>
							<DataTemplate>
								<TextBlock Text="{Binding Name}" />
							</DataTemplate>
						</ListView.ItemTemplate>
					</ListView>
				</DockPanel>
			</Grid>
		</TabItem>
		<TabItem Header="Categories" DataContext="{Binding CategoriesPanel}" Height="20" VerticalAlignment="Top">
			<TabItem.Resources>
				<CollectionViewSource Source="{Binding Categories}" x:Key="categories" IsLiveSortingRequested="True">
					<CollectionViewSource.SortDescriptions>
						<componentmodel:SortDescription PropertyName="Name" />
					</CollectionViewSource.SortDescriptions>
				</CollectionViewSource>
				<Style x:Key="textBoxInError" TargetType="{x:Type TextBox}">
					<Style.Triggers>
						<Trigger Property="Validation.HasError" Value="True">
							<Setter Property="Background" Value="Pink" />
							<Setter Property="ToolTip"
									Value="{Binding RelativeSource={x:Static RelativeSource.Self}, Path=(Validation.Errors)/ErrorContent}" />
						</Trigger>
					</Style.Triggers>
				</Style>
			</TabItem.Resources>
			<DockPanel>
				<DockPanel DockPanel.Dock="Right" Width="150pt" >
					<Button Content="_Delete" DockPanel.Dock="Bottom" Command="{Binding DeleteCommand}" />
					<StackPanel Margin="5,0,5,0" DataContext="{StaticResource categories}">
						<Label Content="_Name" Target="{Binding ElementName=CategoryName}" />
						<TextBox Name="CategoryName"
								 MaxLength="100"
								 Style="{StaticResource textBoxInError}">
							<TextBox.Text>
								<Binding Path="Name" UpdateSourceTrigger="LostFocus">
									<Binding.ValidationRules>
										<ExceptionValidationRule />
									</Binding.ValidationRules>
								</Binding>
							</TextBox.Text>
						</TextBox>
					</StackPanel>
				</DockPanel>
				<Button Content="_Add new" DockPanel.Dock="Bottom" Command="{Binding AddCommand}" />
				<ListView ItemsSource="{Binding Source={StaticResource categories}}" IsSynchronizedWithCurrentItem="True" SelectedItem="{Binding SelectedCategory}">
					<ListView.ItemTemplate>
						<DataTemplate>
							<TextBlock Text="{Binding Name}" />
						</DataTemplate>
					</ListView.ItemTemplate>
				</ListView>
			</DockPanel>
		</TabItem>
	</TabControl>
</Window>
